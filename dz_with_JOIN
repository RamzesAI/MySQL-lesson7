
USE x;

/*
1. Составьте список пользователей users, которые осуществили хотя бы один заказ orders в интернет магазине.
*/

SELECT u.name 
FROM orders o 
	JOIN users u ON o.user_id = u.id
GROUP BY name;


/*
 2. Выведите список товаров products и разделов catalogs, который соответствует товару.
 */

SELECT p.name, c.name
FROM products p 
	LEFT JOIN catalogs c ON p.catalog_id = c.id 
	
/*
 3. (по желанию) Пусть имеется таблица рейсов flights (id, from, to) и таблица городов cities (label, name). 
 Поля from, to и label содержат английские названия городов, поле name — русское. 
 Выведите список рейсов flights с русскими названиями городов.
 */

-- Для удобства вывода и восприятия составил БД

DROP DATABASE fl;

CREATE DATABASE fl;

USE fl;


CREATE TABLE flights(
	id int unsigned NOT NULL AUTO_INCREMENT PRIMARY KEY,
	from_town varchar(145) NOT NULL,
	to_town varchar(145) NOT NULL
);

INSERT INTO flights VALUES
	(1, 'moscow', 'omsk'), 
	(2, 'novgorod', 'kazan'), 
	(3, 'irkutsk', 'moscow'),
	(4, 'omsk', 'irkutsk'),
	(5, 'moscow', 'kazan');

CREATE TABLE cities(
	eng varchar(145) NOT NULL,
	rus varchar(145) NOT NULL,
	PRIMARY KEY(eng, rus)
);

INSERT INTO cities VALUES
	('moscow', 'Москва'), 
	('irkutsk', 'Иркутск'), 
	('novgorod', 'Новгород'),
	('kazan', 'Казань'),
	('omsk', 'Омск');


-- Вывод данных 

SELECT f.id, c.rus AS one, c2.rus AS two FROM flights f
JOIN cities c ON f.from_town = c.eng
JOIN cities c2 ON f.to_town = c2.eng 
